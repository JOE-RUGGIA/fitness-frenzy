<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Idle Clicker â€“ V0.2.1 (Emoji Icons)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#111" />
  <style>
    :root {
      --bg: #0f1114; --card: #15181d; --ink: #e9eef3; --muted: #9aa7b3;
      --accent: #2e7d32; --border: #232a33; --radius: 14px;
      --space: clamp(10px, 2.2vw, 18px);
      --fs-1: clamp(16px, 2.4vw, 18px);
      --fs-2: clamp(18px, 3.2vw, 22px);
      --fs-3: clamp(22px, 5vw, 28px);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg); color: var(--ink);
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
      padding: env(safe-area-inset-top) var(--space) env(safe-area-inset-bottom) var(--space);
    }
    .wrap { max-width: 920px; margin: 0 auto; }
    header { display: flex; align-items: center; gap: var(--space); margin: var(--space) 0; }
    h1 { font-size: var(--fs-3); margin: 0; font-weight: 700; letter-spacing: 0.2px; }

    .row { display: flex; gap: var(--space); flex-wrap: wrap; }
    .card {
      background: var(--card); border-radius: var(--radius); border: 1px solid var(--border);
      padding: var(--space); flex: 1 1 280px; min-width: 260px;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset, 0 10px 24px rgba(0,0,0,0.25);
    }
    h3 { margin: 0 0 10px 0; font-size: var(--fs-2); }
    .muted { color: var(--muted); }
    .stat { font-variant-numeric: tabular-nums; }

    .btn {
      user-select: none; -webkit-tap-highlight-color: transparent;
      background: var(--accent); color: white; border: none; border-radius: 12px;
      padding: clamp(10px, 2.5vh, 14px) clamp(14px, 3vw, 18px);
      font-size: var(--fs-1); font-weight: 600; line-height: 1;
      cursor: pointer; transition: transform .02s ease-out, filter .12s ease;
      touch-action: manipulation; width: 100%;
    }
    .btn:active { transform: translateY(1px); filter: brightness(0.95); }
    .btn[disabled] { background: #3a434f; color: #a7b1be; cursor: not-allowed; transform: none; }
    .btn.secondary { background: #2b3c4f; }
    .btn.secondary:active { filter: brightness(1.08); }

    .grid-2 { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: var(--space); }
    @media (max-width: 560px) { .grid-2 { grid-template-columns: 1fr; } }

    .row-compact { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
    .kpi { display:flex; align-items:center; gap:10px; }
    .icon { font-size: clamp(22px, 6vw, 34px); line-height: 1; filter: drop-shadow(0 2px 1px rgba(0,0,0,0.6)); }
    .spacer { height: var(--space); }
    .status { min-height: 1.2em; }
    .switch { display:flex; align-items:center; gap:8px; font-size: var(--fs-1); }
    input[type="checkbox"] { width: 18px; height: 18px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <span class="icon" id="coinIconHeader" aria-hidden="true">ðŸª™</span>
      <h1>Idle Clicker</h1>
    </header>

    <div class="row">
      <div class="card">
        <h3>Bank</h3>
        <div class="kpi">
          <span class="icon" id="coinIconBank" aria-hidden="true">ðŸª™</span>
          <div>Coins: <span id="coins" class="stat">0</span></div>
        </div>
        <div class="muted">Per tap: <span id="perTap" class="stat">1</span></div>
        <div class="muted">Idle/sec: <span id="perSec" class="stat">0</span></div>
        <div class="spacer"></div>
        <div class="grid-2">
          <button id="tapBtn" class="btn">Tap (+)</button>
          <button id="saveBtn" class="btn secondary">Save</button>
          <button id="resetBtn" class="btn secondary">Hard Reset</button>
          <label class="switch"><input id="muteToggle" type="checkbox" /> Mute</label>
        </div>
        <div id="status" class="muted status"></div>
      </div>

      <div class="card">
        <h3>Upgrades</h3>
        <div class="row-compact">
          <div>
            <div><strong>Auto-Tapper</strong></div>
            <div class="muted">Each adds 1 tap/sec (multiplier applies)</div>
            <div class="muted">Owned: <span id="autoOwned" class="stat">0</span></div>
          </div>
          <button id="buyAutoBtn" class="btn">Buy (cost <span id="autoCost" class="stat">15</span>)</button>
        </div>
        <div class="spacer"></div>
        <div class="row-compact">
          <div>
            <div><strong>Multiplier</strong></div>
            <div class="muted">+100% to taps & idle per level</div>
            <div class="muted">Level: <span id="multOwned" class="stat">1</span></div>
          </div>
          <button id="buyMultBtn" class="btn">Buy (cost <span id="multCost" class="stat">50</span>)</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  // ==========================
  // CONFIG: emoji vs. GitHub
  // ==========================
  const CONFIG = {
    USE_EMOJI_ICONS: true,  // <- keep true for prototype (emoji). Set to false to use images.
    ASSET_BASE: "",         // e.g., "https://YOUR-USER.github.io/YOUR-REPO/assets"
    IMAGES: { coin: "images/coin.png" },
    SOUNDS: { tap: "sounds/click.wav", buy: "sounds/buy.wav" }
  };
  const url = (path) => {
    const base = (CONFIG.ASSET_BASE || "").replace(/\/$/, "");
    const clean = (path || "").replace(/^\//, "");
    return base ? `${base}/${clean}` : `./assets/${clean}`;
  };

  const VERSION = '0.2.1';
  const SAVE_KEY = 'idle_clicker_save_v' + VERSION;

  const state = {
    coins: 0,
    perTapBase: 1,
    multiplierLevel: 1,
    autoOwned: 0,
    lastTS: performance.now(),
    lastSavedAt: Date.now(),
    muted: false
  };

  const costs = { auto: { base: 15, growth: 1.15 }, mult: { base: 50, growth: 1.20 } };

  const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
  const pow = Math.pow;
  const fmt = (n) => (n>=1e12)?(n/1e12).toFixed(2)+'T':(n>=1e9)?(n/1e9).toFixed(2)+'B':(n>=1e6)?(n/1e6).toFixed(2)+'M':(n>=1e3)?(n/1e3).toFixed(2)+'K':Math.floor(n).toString();
  const costFor = (owned, {base,growth}) => Math.floor(base * pow(growth, owned));
  const totalPerTap = () => state.perTapBase * state.multiplierLevel;
  const totalPerSec = () => state.autoOwned * totalPerTap();

  // ---- Audio (uses local or GitHub sounds; safe if files don't exist) ----
  function safeAudio(src) {
    const a = new Audio(src);
    a.preload = 'auto';
    a.volume = 0.8;
    a.onerror = () => { /* stay silent if missing */ };
    return a;
  }
  const sfx = {
    tap: safeAudio(url(CONFIG.SOUNDS.tap)),
    buy: safeAudio(url(CONFIG.SOUNDS.buy))
  };
  let audioUnlocked = false;
  function unlockAudioOnce() {
    if (audioUnlocked) return; audioUnlocked = true;
    try { sfx.tap.muted = true; sfx.tap.play().then(()=>{ sfx.tap.pause(); sfx.tap.currentTime=0; sfx.tap.muted = state.muted; }); } catch {}
  }
  function playSfx(aud){ if(state.muted) return; try{ aud.currentTime=0; aud.play(); }catch{} }

  // ---- Persistence ----
  function save(){
    localStorage.setItem(SAVE_KEY, JSON.stringify({
      coins:state.coins, multiplierLevel:state.multiplierLevel, autoOwned:state.autoOwned,
      lastSavedAt: Date.now(), muted: state.muted, version: VERSION
    }));
    ui.status.textContent = 'Saved.'; setTimeout(()=>ui.status.textContent='',800);
  }
  function load(){
    const raw = localStorage.getItem(SAVE_KEY); if(!raw) return;
    try{
      const s = JSON.parse(raw);
      state.coins = s.coins ?? state.coins;
      state.multiplierLevel = s.multiplierLevel ?? state.multiplierLevel;
      state.autoOwned = s.autoOwned ?? state.autoOwned;
      state.lastSavedAt = s.lastSavedAt ?? Date.now();
      state.muted = !!s.muted;
      const secs = clamp((Date.now()-state.lastSavedAt)/1000, 0, 60*60*24);
      state.coins += totalPerSec() * secs;
    }catch{}
  }

  // ---- Economy ----
  const canAfford = (c)=> state.coins>=c;
  function tap(){ state.coins += totalPerTap(); playSfx(sfx.tap); }
  function buyAuto(){ const c=costFor(state.autoOwned,costs.auto); if(!canAfford(c))return false; state.coins-=c; state.autoOwned++; playSfx(sfx.buy); return true; }
  function buyMult(){ const c=costFor(state.multiplierLevel-1,costs.mult); if(!canAfford(c))return false; state.coins-=c; state.multiplierLevel++; playSfx(sfx.buy); return true; }

  // ---- Loop ----
  const STEP=100; let acc=0;
  function update(dt){ acc+=dt; while(acc>=STEP){ state.coins += totalPerSec()*(STEP/1000); acc-=STEP; } }
  function render(){
    ui.coins.textContent = fmt(state.coins);
    ui.perTap.textContent = fmt(totalPerTap());
    ui.perSec.textContent = fmt(totalPerSec());
    ui.autoOwned.textContent = state.autoOwned;
    ui.multOwned.textContent = state.multiplierLevel;
    const nextAutoCost=costFor(state.autoOwned,costs.auto);
    const nextMultCost=costFor(state.multiplierLevel-1,costs.mult);
    ui.autoCost.textContent = fmt(nextAutoCost);
    ui.multCost.textContent = fmt(nextMultCost);
    ui.buyAutoBtn.disabled = !canAfford(nextAutoCost);
    ui.buyMultBtn.disabled = !canAfford(nextMultCost);
    ui.muteToggle.checked = state.muted;
  }
  function tick(ts){ const dt=ts-state.lastTS; state.lastTS=ts; update(dt); render(); requestAnimationFrame(tick); }

  // ---- UI wiring ----
  const ui = {
    coins: document.getElementById('coins'),
    perTap: document.getElementById('perTap'),
    perSec: document.getElementById('perSec'),
    tapBtn: document.getElementById('tapBtn'),
    buyAutoBtn: document.getElementById('buyAutoBtn'),
    buyMultBtn: document.getElementById('buyMultBtn'),
    autoOwned: document.getElementById('autoOwned'),
    multOwned: document.getElementById('multOwned'),
    autoCost: document.getElementById('autoCost'),
    multCost: document.getElementById('multCost'),
    saveBtn: document.getElementById('saveBtn'),
    resetBtn: document.getElementById('resetBtn'),
    status: document.getElementById('status'),
    muteToggle: document.getElementById('muteToggle'),
    coinIconHeader: document.getElementById('coinIconHeader'),
    coinIconBank: document.getElementById('coinIconBank')
  };
  function bindPress(el, handler){
    el.addEventListener('pointerdown', (e)=>{ e.preventDefault(); unlockAudioOnce(); handler(e); }, { passive:false });
    el.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); handler(e);} });
  }
  bindPress(ui.tapBtn, ()=>{ tap(); render(); });
  bindPress(ui.buyAutoBtn, ()=>{ if(buyAuto()) render(); });
  bindPress(ui.buyMultBtn, ()=>{ if(buyMult()) render(); });
  bindPress(ui.saveBtn, save);
  bindPress(ui.resetBtn, ()=>{
    if(!confirm('Hard reset? This clears your save.')) return;
    localStorage.removeItem(SAVE_KEY); location.reload();
  });
  ui.muteToggle.addEventListener('change', ()=>{ state.muted = ui.muteToggle.checked; sfx.tap.muted=state.muted; sfx.buy.muted=state.muted; });

  // ---- Optional: switch to GitHub images later ----
  function maybeSwapIconsToImages(){
    if (CONFIG.USE_EMOJI_ICONS) return; // keep emojis now
    const coinURL = url("images/coin.png");
    // Replace emoji spans with <img> elements
    [ui.coinIconHeader, ui.coinIconBank].forEach(span=>{
      const img = new Image();
      img.alt = "Coin"; img.decoding="async"; img.loading="lazy";
      img.style.width = getComputedStyle(span).fontSize; // size roughly like emoji
      img.style.height = "auto";
      img.onerror = ()=>{/* keep emoji if image fails */};
      img.onload = ()=>{ span.replaceWith(img); };
      img.src = coinURL;
    });
  }

  function boot(){
    load(); render();
    requestAnimationFrame((ts)=>{ state.lastTS=ts; requestAnimationFrame(tick); });
    setInterval(save, 15000);
    maybeSwapIconsToImages(); // will do nothing while USE_EMOJI_ICONS = true
  }
  boot();
  </script>
</body>
</html>
